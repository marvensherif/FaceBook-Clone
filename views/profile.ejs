<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <title>Magic Wand</title>
  <link rel="stylesheet" href="/css/profile.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.0.4/popper.js"></script>
  <link href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-wvfXpqpZZVQGK6TAh5PVlGOfQNHSoD2xbE+QkPxCAFlNEevoEH3Sl0sibVcOQVnN" crossorigin="anonymous">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js" integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl" crossorigin="anonymous"></script>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css" integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm" crossorigin="anonymous">
  <link href="https://fonts.googleapis.com/css2?family=Bree+Serif&family=Poppins:wght@200&display=swap" rel="stylesheet">
  <script src="https://kit.fontawesome.com/7469e0be29.js" crossorigin="anonymous"></script>
  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=El+Messiri:wght@500&family=Lobster&family=Modak&display=swap" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css2?family=Anton&display=swap" rel="stylesheet">
  <link href="/css/emoji.css" rel="stylesheet">
<link rel="stylesheet" href="/css/font.css">
<link rel="icon" href="/images/favicon.ico">
</head>

<body>

  <div id="scrollPath"></div>
  <div id="progressbar"></div>
  <nav class="navbar navbar-expand-lg navbar-dark fixed-top ">

    <span class="navbar-brand mb-0 h1 anton">Magic-Wand</span>

    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarTogglerDemo02">
      <span class="navbar-toggler-icon"></span>
    </button>



    <div class="collapse navbar-collapse" id="navbarTogglerDemo02">

      <ul class="navbar-nav ml-auto">



        <li class="nav-item">
          <a class="nav-link navbar-brand" href="/home/<%=id%>">HOME</a>
        </li>

     <%if(hisid===null){%>
        <li class="nav-item">

          <div class="dropdown show">
            <a class="btn nav-link navbar-brand" href="#" data-toggle="dropdown" aria-haspopup="false" aria-expanded="true">
              <svg class="bi bi-bell" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                <path d="M8 16a2 2 0 002-2H6a2 2 0 002 2z" />
                <path fill-rule="evenodd"
                  d="M8 1.918l-.797.161A4.002 4.002 0 004 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4.002 4.002 0 00-3.203-3.92L8 1.917zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 111.99 0A5.002 5.002 0 0113 6c0 .88.32 4.2 1.22 6z"
                  clip-rule="evenodd" />
              </svg>
               <span class="w3-badge w3-right w3-small w3-green"><%=pendings.length%></span>
            </a>

            <div class="dropdown-menu x d " aria-labelledby="dropdownMenuLink">

              <%pendings.forEach(function(user){%>

                  <a class="dropdown-item" style="font-size:13px; font-weight: bold;" href="/search/<%=id%>/<%=user._id%>"><%=user.fname%></a>
                  <p class="dropdown-item c">send you friend request</p>


              <%});%>




            </div>

          </div>

        </li>
       <%}%>
        <li class="nav-item ">
          <div class="dropdown show e">
            <a class="btn nav-link navbar-brand dropdown-toggle" href="#" role="button" id="dropdownMenuLink" data-toggle="dropdown" aria-haspopup="false" aria-expanded="true">

            </a>

            <div class="dropdown-menu x" aria-labelledby="dropdownMenuLink">


              <a class="dropdown-item " style="font-size:13px; font-weight: bold;" href="/logout">LOGOUT</a>
            </div>
          </div>

        </li>
      </ul>
      <form class="form-inline my-2 my-lg-0  " action="/search/<%=id%>" method="post" id="LocateOnMap">
        <input type="text" class="form-control" autocomplete="off" spellcheck="false" name="search" placeholder="Search">
        <button class="btn btn-default" type="submit">
          <svg class="bi bi-search" width="1em" height="1em" viewBox="0 0 15 15" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M10.442 10.442a1 1 0 011.415 0l3.85 3.85a1 1 0 01-1.414 1.415l-3.85-3.85a1 1 0 010-1.415z" clip-rule="evenodd" />
            <path fill-rule="evenodd" d="M6.5 12a5.5 5.5 0 100-11 5.5 5.5 0 000 11zM13 6.5a6.5 6.5 0 11-13 0 6.5 6.5 0 0113 0z" clip-rule="evenodd" />
          </svg>
        </button>
      </form>
  </nav>

  <div class="container">
    <div class="profile-header">
      <div class="profile-img">
        <img src=<%=imgSRC%> width="200" alt="">
      </div>
      <div class="profile-nav-info">
        <h3 class="username"><%=fname%> <%=lname%></h3>
        <div class="address">
          <p class="states"><%=hometown%></p>

        </div>
      </div>
      <div class="profile-option">

      </div>
    </div>
    <%let added = 0%>
    <%friends.forEach(function(friend){%>
    <%if(hisid === friend){%>
    <%  added = 1 ;%>
    <%}});%>


    <div class="main-bd">
      <div class="left-side">
        <div class="profile-side">
          <%if(phone !="" ){%>
          <p class="mobile-no"><i class="fa fa-phone"></i><%=phone%></p>
            <%}%>
          <p class="user-mail"><i class="fa fa-envelope"></i><%=email%></p>
          <%if(added ===1 || hisid === null && date!="" ){%>
          <p class="user-birthdate"><i class="fas fa-calendar-times"></i><%=date%></p>
          <%}%>

<%  if(Bio != ""){ %>
          <div class="user-bio">
            <h3>Bio</h3>
            <p class="bio"> <%=Bio%> </p>
          </div>
          <%}%>
          <div class="profile-btn">


            <%let sendreq = 0%>
          <%let gotreq = 0%>






          <%pendings.forEach(function(reqs){%>
          <%if(hisid === reqs){%>
          <%  gotreq = 1 ;%>
          <%}});%>



          <%pendings2.forEach(function(req){%>
          <%if(id === req){%>
          <%  sendreq = 1 ;%>

          <%}});%>

          <%if(added === 0 && sendreq === 0 && gotreq === 0 && hisid != null && hisid != id){%>
          <form action="/addfriend/<%=id%>/<%=hisid%>" method="post">
            <button class="createbtn" type="submit" name="button"><i class="fas fa-user-plus"></i>ADD FRIEND</button>
          </form>
          <%}else if(added === 1 ){%>
          <button class="createbtn" type="button" name="button"><i class="fas fa-user-friends"></i>FRIENDS</button>
          <%}else if(sendreq === 1){%>
          <button class="createbtn" type="button" name="button">PENDING</button>
          <%}else if(gotreq === 1 ){%>
          <form class="" action="/accept/<%=id%>/<%=hisid%>" method="post">
            <button class="createbtn" type="submit" name="button"><i class="fas fa-check"></i>ACCEPT</button>
          </form>
          <form class="" action="/refuse/<%=id%>/<%=hisid%>" method="post">
            <button class="createbtn" type="submit" name="button"><i class="fas fa-times"></i>REFUSE</button>
          </form>
          <%}%>




      </div>

    </div>
  </div>
<div class="right-side">
  <div class="navigate">
    <ul>
      <li  onclick="tabs(0)" class="user-post active">POSTS</li>
      <li onclick="tabs(1)" class="user-review">FRIEND LIST</li>
      <%if(hisid===null){%>
      <li onclick="tabs(2)" class="user-setting">SETTINGS</li>
    <%}%>
    </ul>
  </div>
  <div class="profile-body">
    <div class="proifle-posts tab" style="resize:none;">
    <%  if(hisid === null){%>
          <div class="form">
            <form action="/post/<%=id%>" method="post" enctype="multipart/form-data">
              <div class="center">
                <span title="Private Post">
                  <input id="checkbox" type="checkbox" name="checkbox">
                </span>

              </div>

              <div class="lead emoji-picker-container" style="display:inline-block">

                <textarea id="code" value="" class="form-control textarea-control" name="tPost" rows="7" cols="50" style="background : #fff; color:black; resize:none; " data-emojiable="true"></textarea>
                <img contenteditable="false" style="padding-bottom:10px; padding-top:10px;" id="blah" />
              </div>










              <div class="myfileupload-buttonbar">

                <label class="myui-button btn  btn-outline-danger ">
                  <span>BROWSE</span>
                  <input name="image" class="fileInput " style="background:#333; color:white;  border:0; " id="file" type='file' onchange="readURL(this);"></input>
                </label>
                <button type="submit" class="myui-button btn btn-outline-primary" style="color:#fff;" name="button">PUBLISH</button>

              </div>


          </div>
          </form>
          <%}%>

      <div class="test">
      <%- messages('my_message_template', locals) %>
<%if(hisid === null || (hisid != null && added === 1) ){%>

          <%allpost.forEach(function(post){%>
          <div class="box">
            <div class="content">

              <form class="" action="/profile/<%=id%>/deletepost" method="post">
                <%if(post.private === 1){%>
                <span title="Private Post" class="private">
                  <svg class="bi bi-lock-fill" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                  <rect width="11" height="9" x="2.5" y="7" rx="2"/>
                  <path fill-rule="evenodd" d="M4.5 4a3.5 3.5 0 117 0v3h-1V4a2.5 2.5 0 00-5 0v3h-1V4z" clip-rule="evenodd"/>
                </svg>
                </span>





                <span class="bi-clock  " title="<%=post.likes.length%> liked your post">
                  <svg class="bi bi-heart-fill " width="1em" height="1em" viewBox="0 0 16 16" fill="red" xmlns="http://www.w3.org/2000/svg">

                <path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z" clip-rule="evenodd"/>
              </svg>
             <%=post.likes.length%>
            </span>


                <%}else{%>
                  <span title="Public Post" class="private"><svg class="bi bi-unlock-fill" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path d="M.5 9a2 2 0 012-2h7a2 2 0 012 2v5a2 2 0 01-2 2h-7a2 2 0 01-2-2V9z"/>
  <path fill-rule="evenodd" d="M8.5 4a3.5 3.5 0 117 0v3h-1V4a2.5 2.5 0 00-5 0v3h-1V4z" clip-rule="evenodd"/>
</svg></span>

<span class="bi-clock  " title="<%=post.likes.length%> liked your post">
  <svg class="bi bi-heart-fill " width="1em" height="1em" viewBox="0 0 16 16" fill="red" xmlns="http://www.w3.org/2000/svg">

<path fill-rule="evenodd" d="M8 1.314C12.438-3.248 23.534 4.735 8 15-7.534 4.736 3.562-3.248 8 1.314z" clip-rule="evenodd"/>
</svg>
<%=post.likes.length%>
</span>


                <%}%>

                <p class="messiri" style="padding-top: 20px;padding-right: 35px;margin-bottom: 0px;"><%=post.post%></p>
                <p class="messiri" style="padding-top: 20px;margin-bottom: 0px;"><%=post.caption%></p>

                <img src="<%=post.imgURL%>" alt="">
                <%if(hisid === null){%>

                <span title="Delete Post">
                  <button value="<%=post._id%>" class="cbutton btn btn-link" type="submit" name="deletepostbutton"><svg class="bi bi-trash" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                      <path d="M5.5 5.5A.5.5 0 016 6v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm2.5 0a.5.5 0 01.5.5v6a.5.5 0 01-1 0V6a.5.5 0 01.5-.5zm3 .5a.5.5 0 00-1 0v6a.5.5 0 001 0V6z" />
                      <path fill-rule="evenodd"
                        d="M14.5 3a1 1 0 01-1 1H13v9a2 2 0 01-2 2H5a2 2 0 01-2-2V4h-.5a1 1 0 01-1-1V2a1 1 0 011-1H6a1 1 0 011-1h2a1 1 0 011 1h3.5a1 1 0 011 1v1zM4.118 4L4 4.059V13a1 1 0 001 1h6a1 1 0 001-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z"
                        clip-rule="evenodd" />
                    </svg></button>
                  <%}%>

                  <span title="<%=post.time%> <%=post.date%>" class="bi-clock">
                  <svg ontouchstart="myFunction()" class="bi bi-clock-history "style="color:#007bff;" width="1em" height="1em" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
<path fill-rule="evenodd" d="M8.515 1.019A7 7 0 008 1V0a8 8 0 01.589.022l-.074.997zm2.004.45a7.003 7.003 0 00-.985-.299l.219-.976c.383.086.76.2 1.126.342l-.36.933zm1.37.71a7.01 7.01 0 00-.439-.27l.493-.87a8.025 8.025 0 01.979.654l-.615.789a6.996 6.996 0 00-.418-.302zm1.834 1.79a6.99 6.99 0 00-.653-.796l.724-.69c.27.285.52.59.747.91l-.818.576zm.744 1.352a7.08 7.08 0 00-.214-.468l.893-.45a7.976 7.976 0 01.45 1.088l-.95.313a7.023 7.023 0 00-.179-.483zm.53 2.507a6.991 6.991 0 00-.1-1.025l.985-.17c.067.386.106.778.116 1.17l-1 .025zm-.131 1.538c.033-.17.06-.339.081-.51l.993.123a7.957 7.957 0 01-.23 1.155l-.964-.267c.046-.165.086-.332.12-.501zm-.952 2.379c.184-.29.346-.594.486-.908l.914.405c-.16.36-.345.706-.555 1.038l-.845-.535zm-.964 1.205c.122-.122.239-.248.35-.378l.758.653a8.073 8.073 0 01-.401.432l-.707-.707z" clip-rule="evenodd"/>
<path fill-rule="evenodd" d="M8 1a7 7 0 104.95 11.95l.707.707A8.001 8.001 0 118 0v1z" clip-rule="evenodd"/>
<path fill-rule="evenodd" d="M7.5 3a.5.5 0 01.5.5v5.21l3.248 1.856a.5.5 0 01-.496.868l-3.5-2A.5.5 0 017 9V3.5a.5.5 0 01.5-.5z" clip-rule="evenodd"/>
</svg>


            </form>
</div>
  </div>
<%});} else{%>

                  <%allpost.forEach(function(post){%>
                  <%if(post.private === 0){%>
                  <div class="box">
                    <div class="content">
                      <p class="messiri" style="padding-top: 20px;margin-bottom: 0px;"><%=post.post%></p>
                      <p class="messiri"style="padding-top: 20px;margin-bottom: 0px;"><%=post.caption%></p>

                      <img src="<%=post.imgURL%>" alt="">
                    </div>
                  </div>
                  <%}});%>

                  <%};%>







                      </div>


                    </div>

                    <div class="proifle-reviews tab">
                      <div class="row">
                        <%friendinfo.forEach(function(friend2){%>

                        <div class="col-md-4">
                          <div class="card mb-4 shadow-sm">
                            <img style="height: 200px;" src="<%=friend2.registerInfo.imgURL%>" alt="">


                            <div style="background:#333;"  class="card-body">
                              <p class="card-text"><a class="btn normal"href="/search/<%=id%>/<%=friend2.registerInfo._id%>"><%=friend2.registerInfo.fname%> <%=friend2.registerInfo.lname%></a></p>

                            </div>
                          </div>
                        </div>
                        <%});%>
                      </div>
                    </div>
                        <%if(hisid === null){%>
                    <div class="proifle-settings tab">
                      <div class="profile-body">
                        <form class="form-signin" action="/edit/profile-setting/<%=id%>" method="post">

                          <div class="form-label-group">
                            <input type="text" name="fname" class="form-control" placeholder="text" value="<%=fname%>" required autofocus autocomplete="off">
                            <label for="fname">First Name</label>
                          </div>

                          <div class="form-label-group">
                            <input type="text" name="lname" class="form-control" placeholder="text" value="<%=lname%>" required autofocus autocomplete="off">
                            <label for="lname">Last Name</label>
                          </div>


                          <div style="width:100%; text-align:left;">

                            <div class="inner form-label-group">
                              <input type="password" name="pass" class="form-control " id="pass" placeholder="Password"  autofocus autocomplete="off">
                              <label for="pass">Current Password</label>
                            </div>
                            <div class="inner form-label-group">
                              <input type="password" name="newpass" class="form-control " id="newpass" placeholder="Password"  autofocus autocomplete="off">
                              <label for="newpass">New Password</label>
                            </div>
                            <div class="inner form-label-group">
                              <input type="password" name="confirmnewpass" class="form-control " id="confirmnewpass" placeholder="Password"  autofocus autocomplete="off">
                              <label for="confrimnewpass">Confirm Password</label>
                            </div>
                          </div>




                          <div class="form-label-group">
                            <input type="number" name="phone" class="form-control"  placeholder="Phone" value="<%=phone%>"  autofocus autocomplete="off">
                            <label for="phone">Phone-Number ex:01xxxxxxxxx</label>

                          </div>

                          <div class="form-label-group">
                            <input type="text" name="hometown" class="form-control" placeholder="Hometown" value="<%=hometown%>" required autofocus autocomplete="off">
                            <label for="hometown">Hometown</label>

                          </div>
                          <div class="form-label-group">
                            <input type="text" name="bio" class="form-control" value="<%=Bio%>"  autofocus>
                            <label for="Bio">Bio</label>
                          </div>

                          <div class="form-label-group">
                            <input type="date" name="date" class="form-control" value="<%=date%>" required autofocus>
                            <label for="date">Date</label>
                          </div>


                          <div class="form-label-group">

                            <select name="gender" class=" form-control" value="<%=gender%>" required autofocus>
                              <option disabled selected>Gender</option>
                              <option selected> <%=gender%></option>
                              <%  if(gender === "Female"){%>
                              <option>Male</option>
                              <%}else{%>
                              <option>Female</option>
                              <%}%>

           </select>

          </div>



          <div class="form-label-group">
           <select name="status"class="form-control"  autofocus>
             <option disabled selected >Martial Status</option>
             <option  selected> <%=status%></option>
                              <%  if(status === "Single" ){%>
                              <option>Engaged</option>
                              <option>Married</option>
                              <%}else if(status === "Married"){%>
                              <option>Single</option>
                              <option>Engaged</option>
                              <%}else{%>
                              <option>Single</option>
                              <option>Married</option>
                              <% }%>



                            </select>
                          </div>


                          <button  class="btn btn-lg btn-primary btn-block font-weight-bold" type="submit">Confirm</button>

                        </form>

                      </div>






                    </div>
                    <%}%>
            </div>
          </div>
        </div>
      </div>

      <!-- * Don't forget to Add jQuery here * -->
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
      <script src="/js/config.js"></script>
      <script src="/js/util.js"></script>
      <script src="/js/jquery.emojiarea.js"></script>
      <script src="/js/emoji-picker.js"></script>
      <script src="/js/main.js" charset="utf-8"></script>
      <script>
        $(function() {
          // Initializes and creates emoji set from sprite sheet
          window.emojiPicker = new EmojiPicker({
            emojiable_selector: '[data-emojiable=true]',
            assetsPath: '/images/',
            popupButtonClasses: 'fa fa-smile-o'
          });
          // Finds all elements with `emojiable_selector` and converts them to rich emoji input fields
          // You may want to delay this step if you have dynamically created input fields that appear later in the loading process
          // It can be called as many times as necessary; previously converted input fields will not be converted again
          window.emojiPicker.discover();
        });
      </script>
      <script>
        // Google Analytics
        (function(i, s, o, g, r, a, m) {
          i['GoogleAnalyticsObject'] = r;
          i[r] = i[r] || function() {
            (i[r].q = i[r].q || []).push(arguments)
          }, i[r].l = 1 * new Date();
          a = s.createElement(o),
            m = s.getElementsByTagName(o)[0];
          a.async = 1;
          a.src = g;
          m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

        ga('create', 'UA-49610253-3', 'auto');
        ga('send', 'pageview');
      </script>

</body>

</html>
<script type="text/javascript">
  function readURL(input) {
    if (input.files && input.files[0]) {
      var reader = new FileReader();

      reader.onload = function(e) {
        $('#blah')
          .attr('src', e.target.result)
          .width(360)
          .height(255);
      };
      reader.readAsDataURL(input.files[0]);
    }
  }
</script>
<script type="text/javascript">
  var one = document.getElementById('pass');
  var two = document.getElementById('newpass');
  var three = document.getElementById('confirmnewpass');

  //checks instantly
  var checker = setInterval(function() {
    if (one.value == '') {
      two.disabled = true;
      three.disabled = true;
    }
    if (one.value != '') {
      two.disabled = false;
    }
    if (one.value != '' && two.value != '') {
      three.disabled = false;
    }

  }, 30);
</script>
<script type="text/javascript">
  document.getElementById("code").value= "texthere\\\ntexttext".
</script>
<script type="text/javascript">
let progress = document.getElementById("progressbar");
let totalHeight = document.body.scrollHeight - window.innerHeight;

window.onscroll = function(){
  let progressHeight = (window.pageYOffset/totalHeight) *100;
  progress.style.height = progressHeight + "%";
}
</script>
<script type="text/javascript">
$(function() {
$('form.my_form').submit(function(event) {
  event.preventDefault(); // Prevent the form from submitting via the browser
  var form = $(this);
  $.ajax({
    type: form.attr('method'),
    url: form.attr('action'),
    data: form.serialize()
  }).done(function(data) {
    // Optionally alert the user of success here...
  }).fail(function(data) {
    // Optionally alert the user of an error here...
  });
});
});
</script>
